# Check if a building uses a certain production method and write data into variable
lroai_check_production_methods_of_building_type = {
    root = {
        switch = {
            trigger = $id$
            4 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 < 6
                        }
                        prev = {
                            lroai_infrastructure_per_level_of_railway = 40
                        }
                    }
                    if = {
                        limit = {
                            has_variable = lroai_building_type_$id$_collected_data
                        }
                        change_variable = {
                            name = lroai_building_type_$id$_collected_data
                            subtract = {
                                value = lroai_building_type_$id$_collected_data_4
                                multiply = 1000000
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 6000000
                    }
                }
                else_if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 < 5
                        }
                        prev = {
                            lroai_infrastructure_per_level_of_railway = 35
                        }
                    }
                    if = {
                        limit = {
                            has_variable = lroai_building_type_$id$_collected_data
                        }
                        change_variable = {
                            name = lroai_building_type_$id$_collected_data
                            subtract = {
                                value = lroai_building_type_$id$_collected_data_4
                                multiply = 1000000
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 5000000
                    }
                }
                else_if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 < 4
                        }
                        prev = {
                            lroai_infrastructure_per_level_of_railway = 30
                        }
                    }
                    if = {
                        limit = {
                            has_variable = lroai_building_type_$id$_collected_data
                        }
                        change_variable = {
                            name = lroai_building_type_$id$_collected_data
                            subtract = {
                                value = lroai_building_type_$id$_collected_data_4
                                multiply = 1000000
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 4000000
                    }
                }
                else_if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 < 3
                        }
                        prev = {
                            lroai_infrastructure_per_level_of_railway = 25
                        }
                    }
                    if = {
                        limit = {
                            has_variable = lroai_building_type_$id$_collected_data
                        }
                        change_variable = {
                            name = lroai_building_type_$id$_collected_data
                            subtract = {
                                value = lroai_building_type_$id$_collected_data_4
                                multiply = 1000000
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 3000000
                    }
                }
                else_if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 < 2
                        }
                        prev = {
                            lroai_infrastructure_per_level_of_railway = 20
                        }
                    }
                    if = {
                        limit = {
                            has_variable = lroai_building_type_$id$_collected_data
                        }
                        change_variable = {
                            name = lroai_building_type_$id$_collected_data
                            subtract = {
                                value = lroai_building_type_$id$_collected_data_4
                                multiply = 1000000
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 2000000
                    }
                }
                else_if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 < 1
                        }
                        prev = {
                            lroai_infrastructure_per_level_of_railway = 15
                        }
                    }
                    if = {
                        limit = {
                            has_variable = lroai_building_type_$id$_collected_data
                        }
                        change_variable = {
                            name = lroai_building_type_$id$_collected_data
                            subtract = {
                                value = lroai_building_type_$id$_collected_data_4
                                multiply = 1000000
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            8 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            has_active_production_method = pm_hardwood
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            18 = {
                if = {
                    limit = {
                        NAND = {
                            has_variable = lroai_building_type_$id$_collected_data
                            lroai_building_type_$id$_collected_data_4 >= 3
                        }
                    }
                    if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 2
                            }
                            prev = {
                                has_active_production_method = pm_potatoes
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 1000000
                        }
                    }
                    else_if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 1
                            }
                            prev = {
                                has_active_production_method = pm_apple_orchards
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 2000000
                        }
                    }
                }
            }
            19 = {
                if = {
                    limit = {
                        NAND = {
                            has_variable = lroai_building_type_$id$_collected_data
                            lroai_building_type_$id$_collected_data_4 >= 3
                        }
                    }
                    if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 2
                            }
                            prev = {
                                has_active_production_method = pm_citrus_orchards
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 1000000
                        }
                    }
                    else_if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 1
                            }
                            prev = {
                                has_active_production_method = pm_vineyards
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 2000000
                        }
                    }
                }
            }
            21 = {
                if = {
                    limit = {
                        NAND = {
                            has_variable = lroai_building_type_$id$_collected_data
                            lroai_building_type_$id$_collected_data_4 >= 3
                        }
                    }
                    if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 2
                            }
                            prev = {
                                has_active_production_method = pm_citrus_orchards
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 1000000
                        }
                    }
                    if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 1
                            }
                            prev = {
                                has_active_production_method = pm_vineyards_building_maize_farm
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 2000000
                        }
                    }
                }
            }
            33 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            OR = {
                                has_active_production_method = pm_pot_stills
                                has_active_production_method = pm_patent_stills
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            34 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            OR = {
                                has_active_production_method = pm_craftsman_sewing
                                has_active_production_method = pm_elastics
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            35 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            OR = {
                                has_active_production_method = pm_luxury_furniture
                                has_active_production_method = pm_precision_tools
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            36 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            OR = {
                                has_active_production_method = pm_ceramics
                                has_active_production_method = pm_bone_china
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            39 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            OR = {
                                has_active_production_method = pm_leblanc_process
                                has_active_production_method = pm_ammonia-soda_process
                                has_active_production_method = pm_vacuum_evaporation
                                has_active_production_method = pm_brine_electrolysis
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            40 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            has_active_production_method = pm_rayon
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            42 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            has_active_production_method = pm_automobile_production
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            43 = {
                if = {
                    limit = {
                        NAND = {
                            has_variable = lroai_building_type_$id$_collected_data
                            lroai_building_type_$id$_collected_data_4 >= 3
                        }
                    }
                    if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 2
                            }
                            prev = {
                                OR = {
                                    has_active_production_method = pm_basic_shipbuilding
                                    has_active_production_method = pm_complex_shipbuilding
                                }
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 1000000
                        }
                    }
                    if = {
                        limit = {
                            OR = {
                                NOT = {
                                    has_variable = lroai_building_type_$id$_collected_data
                                }
                                lroai_building_type_$id$_collected_data_4 = 0
                                lroai_building_type_$id$_collected_data_4 = 1
                            }
                            prev = {
                                OR = {
                                    has_active_production_method = pm_metal_shipbuilding
                                    has_active_production_method = pm_arc_welding_shipbuilding
                                }
                            }
                        }
                        lroai_add_to_variable = {
                            name = lroai_building_type_$id$_collected_data
                            value = 2000000
                        }
                    }
                }
            }
            45 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            has_active_production_method = pm_radios
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            46 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            OR = {
                                has_active_production_method = pm_cannons
                                has_active_production_method = pm_smoothbores
                                has_active_production_method = pm_breech_loaders
                            }
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
            48 = {
                if = {
                    limit = {
                        OR = {
                            NOT = {
                                has_variable = lroai_building_type_$id$_collected_data
                            }
                            lroai_building_type_$id$_collected_data_4 = 0
                        }
                        prev = {
                            has_active_production_method = pm_tank_production
                        }
                    }
                    lroai_add_to_variable = {
                        name = lroai_building_type_$id$_collected_data
                        value = 1000000
                    }
                }
            }
        }
    }
}

# -------------------------
# Government administration
# -------------------------

lroai_evaluate_building_government_administration = {
    lroai_evaluate_with_custom_trigger = {
        id = $id$
        crucial = $crucial$
    }
}

# ----------
# University
# ----------

lroai_evaluate_building_university = {
    lroai_evaluate_with_custom_trigger = {
        id = $id$
        crucial = $crucial$
    }
}

# -------------------
# Construction sector
# -------------------

lroai_evaluate_building_construction_sector = {
    lroai_evaluate_with_custom_trigger = {
        id = $id$
        crucial = $crucial$
    }
}

# -------
# Railway
# -------

lroai_evaluate_building_railway = {
    lroai_evaluate_with_custom_trigger = {
        id = $id$
        crucial = $crucial$
    }
}

# ----
# Port
# ----

lroai_evaluate_building_port = {
    lroai_evaluate_with_custom_trigger = {
        id = $id$
        crucial = $crucial$
    }
}

# --------
# Barracks
# --------

lroai_evaluate_building_barracks = {
    lroai_evaluate_with_custom_trigger = {
        id = $id$
        crucial = $crucial$
    }
}

# ----------
# Naval base
# ----------

lroai_evaluate_building_naval_base = {
    lroai_evaluate_with_custom_trigger = {
        id = $id$
        crucial = $crucial$
    }
}

# ------------
# Logging camp
# ------------

lroai_evaluate_building_logging_camp = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:wood
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:hardwood
            offset = 0
        }
    }
}

# -------------
# Fishing wharf
# -------------

lroai_evaluate_building_fishing_wharf = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:fish
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:grain
        offset = 4
    }
}

# ---------------
# Whaling station
# ---------------

lroai_evaluate_building_whaling_station = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:oil
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:meat
        offset = 6
    }
}

# -----------------
# Rubber plantation
# -----------------

lroai_evaluate_building_rubber_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:rubber
        offset = 0
    }
}

# -------
# Oil rig
# -------

lroai_evaluate_building_oil_rig = {
    if = {
        limit = {
            any_scope_state = {
                has_potential_resource = bg_oil_extraction
            }
            NOT = {
                has_variable = lroai_building_type_$id$_collected_data
            }
        }
        set_local_variable = {
            name = lroai_saved_priority_level
            value = 2
        }
        set_local_variable = {
            name = lroai_saved_supply_vs_demand_level
            value = 1
        }
        set_local_variable = {
            name = lroai_saved_productivity_requirement_level
            value = 1
        }
    }
    else = {
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:oil
            offset = 0
        }
    }
}

# ---------
# Coal mine
# ---------

lroai_evaluate_building_coal_mine = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:coal
        offset = 0
    }
}

# ---------
# Iron mine
# ---------

lroai_evaluate_building_iron_mine = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:iron
        offset = 0
    }
}

# ---------
# Lead mine
# ---------

lroai_evaluate_building_lead_mine = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:lead
        offset = 0
    }
}

# -----------
# Sulfur mine
# -----------

lroai_evaluate_building_sulfur_mine = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:sulfur
        offset = 0
    }
}

# ---------
# Gold mine
# ---------

lroai_evaluate_building_gold_mine = {
    set_local_variable = {
        name = lroai_saved_priority_level
        value = 6
    }
    set_local_variable = {
        name = lroai_saved_supply_vs_demand_level
        value = 5
    }
    set_local_variable = {
        name = lroai_saved_productivity_requirement_level
        value = 5
    }
    if = {
        limit = {
            OR = {
                always = yes
                $id$ = 0
                $crucial$ = 0
            }
        }
    }
}

# --------
# Rye farm
# --------

lroai_evaluate_building_rye_farm = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:grain
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 = 1
                lroai_building_type_$id$_collected_data_4 >= 3
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:liquor
            offset = 6
        }
    }
}

# ----------
# Wheat farm
# ----------

lroai_evaluate_building_wheat_farm = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:grain
        offset = 0
    }
}

# ---------
# Rice farm
# ---------

lroai_evaluate_building_rice_farm = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:grain
        offset = 0
    }
}

# ----------
# Maize farm
# ----------

lroai_evaluate_building_maize_farm = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:grain
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 = 2
                lroai_building_type_$id$_collected_data_4 >= 3
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:wine
            offset = 6
        }
    }
}

# -----------
# Millet farm
# -----------

lroai_evaluate_building_millet_farm = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:grain
        offset = 0
    }
}

# ---------------
# Livestock ranch
# ---------------

lroai_evaluate_building_livestock_ranch = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:fabric
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:meat
        offset = 0
    }
}

# -----------------
# Cotton plantation
# -----------------

lroai_evaluate_building_cotton_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:fabric
        offset = 0
    }
}

# --------------
# Dye plantation
# --------------

lroai_evaluate_building_dye_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:dye
        offset = 0
    }
}

# ---------------
# Silk plantation
# ---------------

lroai_evaluate_building_silk_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:silk
        offset = 0
    }
}

# -----------------
# Banana plantation
# -----------------

lroai_evaluate_building_banana_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:fruit
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:grain
        offset = 4
    }
}

# ----------------
# Sugar plantation
# ----------------

lroai_evaluate_building_sugar_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:sugar
        offset = 0
    }
}

# --------------
# Tea plantation
# --------------

lroai_evaluate_building_tea_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:tea
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:coffee
        offset = 4
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:wine
        offset = 4
    }
}

# -----------------
# Coffee plantation
# -----------------

lroai_evaluate_building_coffee_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:coffee
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:tea
        offset = 4
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:wine
        offset = 4
    }
}

# ------------------
# Tobacco plantation
# ------------------

lroai_evaluate_building_tobacco_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:tobacco
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:liquor
        offset = 4
    }
    if = {
        limit = {
            NOT = {
                is_banning_goods = g:opium
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:opium
            offset = 4
        }
    }
}

# ----------------
# Opium plantation
# ----------------

lroai_evaluate_building_opium_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:opium
        offset = 0
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:liquor
        offset = 4
    }
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:tobacco
        offset = 4
    }
}

# -------------
# Food industry
# -------------

lroai_evaluate_building_food_industry = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:groceries
        offset = 0
    }
    if = {
        limit = {
            has_technology_researched = distillation
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:liquor
            offset = 0
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:tobacco
            offset = 4
        }
        if = {
            limit = {
                NOT = {
                    is_banning_goods = g:opium
                }
            }
            lroai_evaluate_production_building = {
                id = $id$
                crucial = $crucial$
                good = mg:opium
                offset = 4
            }
        }
    }
}

# -------------
# Textile mills
# -------------

lroai_evaluate_building_textile_mills = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:clothes
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:luxury_clothes
            offset = 0
        }
    }
}

# -----------------------
# Furniture manufacturies
# -----------------------

lroai_evaluate_building_furniture_manufacturies = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:furniture
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:luxury_furniture
            offset = 0
        }
    }
}

# ----------
# Glassworks
# ----------

lroai_evaluate_building_glassworks = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:glass
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:porcelain
            offset = 0
        }
    }
}

# -----------------
# Tooling workshops
# -----------------

lroai_evaluate_building_tooling_workshops = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:tools
        offset = 0
    }
}

# -----------
# Paper mills
# -----------

lroai_evaluate_building_paper_mills = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:paper
        offset = 0
    }
}

# ---------------
# Chemical plants
# ---------------

lroai_evaluate_building_chemical_plants = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:fertilizer
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:explosives
            offset = 0
        }
    }
}

# ----------------
# Synthetic plants
# ----------------

lroai_evaluate_building_synthetics_plants = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:dye
        offset = 0
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:silk
            offset = 0
        }
    }
}

# -----------
# Steel mills
# -----------

lroai_evaluate_building_steel_mills = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:steel
        offset = 0
    }
}

# --------------
# Motor industry
# --------------

lroai_evaluate_building_motor_industry = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:engines
        offset = 0
    }
    if = {
        limit = {
            has_technology_researched = combustion_engine
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:automobiles
            offset = 0
        }
    }
}

# ---------
# Shipyards
# ---------

lroai_evaluate_building_shipyards = {
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 = 1
                lroai_building_type_$id$_collected_data_4 >= 3
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:clippers
            offset = 0
        }
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 = 2
                lroai_building_type_$id$_collected_data_4 >= 3
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:steamers
            offset = 0
        }
    }
}

# -----------
# Power plant
# -----------

lroai_evaluate_building_power_plant = {
    if = {
        limit = {
            NOT = {
                has_variable = lroai_building_type_$id$_collected_data
            }
        }
        set_local_variable = {
            name = lroai_saved_priority_level
            value = 2
        }
        set_local_variable = {
            name = lroai_saved_supply_vs_demand_level
            value = 1
        }
        set_local_variable = {
            name = lroai_saved_productivity_requirement_level
            value = 1
        }
    }
    else = {
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:electricity
            offset = 0
        }
    }
}

# ------------------
# Electrics industry
# ------------------

lroai_evaluate_building_electrics_industry = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:telephones
        offset = 0
    }
    if = {
        limit = {
            has_technology_researched = radio
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:radios
            offset = 0
        }
    }
}

# -------------
# Arms industry
# -------------

lroai_evaluate_building_arms_industry = {
    if = {
        limit = {
            OR = {
                lroai_is_using_military_forces = no
                market.mg:small_arms.lroai_supply_vs_demand_level <= lroai_max_level_when_using_military_forces
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:small_arms
            offset = 0
        }
    }
}

# ---------------
# Munition plants
# ---------------

lroai_evaluate_building_munition_plants = {
    if = {
        limit = {
            OR = {
                lroai_is_using_military_forces = no
                market.mg:ammunition.lroai_supply_vs_demand_level <= lroai_max_level_when_using_military_forces
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:ammunition
            offset = 0
        }
    }
}

# --------------------
# War machine industry
# --------------------

lroai_evaluate_building_war_machine_industry = {
    if = {
        limit = {
            OR = {
                lroai_is_using_military_forces = no
                market.mg:aeroplanes.lroai_supply_vs_demand_level <= lroai_max_level_when_using_military_forces
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:aeroplanes
            offset = 0
        }
    }
    if = {
        limit = {
            has_technology_researched = mobile_armor
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 >= 1
            }
            OR = {
                lroai_is_using_military_forces = no
                market.mg:tanks.lroai_supply_vs_demand_level <= lroai_max_level_when_using_military_forces
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:tanks
            offset = 0
        }
    }
}

# ------------
# Arts academy
# ------------

lroai_evaluate_building_arts_academy = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:fine_art
        offset = 0
    }
}

# -----------------
# Special buildings
# -----------------

lroai_construct_special_buildings = {
    set_variable = lroai_tried_special_buildings

    # Suez Canal
    if = {
        limit = {
            has_technology_researched = colonization
            owns_treaty_port_in = STATE_SINAI
            has_variable = suez_survey_complete
            NOT = {
                s:STATE_SINAI = {
                    any_scope_state = {
                        any_scope_building = {
                            is_building_type = building_suez_canal
                        }
                    }
                }
            }
        }
        set_local_variable = {
            name = lroai_started_building_construction
            value = yes
            days = lroai_days_to_keep_short_variables
        }
        s:STATE_SINAI = {
            random_scope_state = {
                limit = {
                    owner = root
                }
                start_building_construction = building_suez_canal
            }
        }
    }
    
    # Panama Canal
    if = {
        limit = {
            has_technology_researched = civilizing_mission
            owns_treaty_port_in = STATE_PANAMA
            has_variable = panama_survey_complete
            NOT = {
                s:STATE_PANAMA = {
                    any_scope_state = {
                        any_scope_building = {
                            is_building_type = building_panama_canal
                        }
                    }
                }
            }
        }
        set_local_variable = {
            name = lroai_started_building_construction
            value = yes
            days = lroai_days_to_keep_short_variables
        }
        s:STATE_PANAMA = {
            random_scope_state = {
                limit = {
                    owner = root
                }
                start_building_construction = building_panama_canal
            }
        }
    }
    
    # Big Ben
    if = {
        limit = {
            s:STATE_HOME_COUNTIES = {
                any_scope_state = {
                    owner = root
                }
                NOT = {
                    any_scope_state = {
                        any_scope_building = {
                            is_building_type = building_big_ben
                        }
                    }
                }
            }
        }
        set_local_variable = {
            name = lroai_started_building_construction
            value = yes
            days = lroai_days_to_keep_short_variables
        }
        s:STATE_HOME_COUNTIES = {
            random_scope_state = {
                limit = {
                    owner = root
                }
                start_building_construction = building_big_ben
            }
        }
    }
    
    # Eiffel Tower
    if = {
        limit = {
            has_technology_researched = steel_frame_buildings
            s:STATE_ILE_DE_FRANCE = {
                any_scope_state = {
                    owner = root
                }
                NOT = {
                    any_scope_state = {
                        any_scope_building = {
                            is_building_type = building_eiffel_tower
                        }
                    }
                }
            }
        }
        set_local_variable = {
            name = lroai_started_building_construction
            value = yes
            days = lroai_days_to_keep_short_variables
        }
        s:STATE_ILE_DE_FRANCE = {
            random_scope_state = {
                limit = {
                    owner = root
                }
                start_building_construction = building_eiffel_tower
            }
        }
    }
    
    # Statue of Liberty
    if = {
        limit = {
            has_technology_researched = steel_frame_buildings
            s:STATE_NEW_YORK = {
                any_scope_state = {
                    owner = root
                }
                NOT = {
                    any_scope_state = {
                        any_scope_building = {
                            is_building_type = building_statue_of_liberty
                        }
                    }
                }
            }
        }
        set_local_variable = {
            name = lroai_started_building_construction
            value = yes
            days = lroai_days_to_keep_short_variables
        }
        s:STATE_NEW_YORK = {
            random_scope_state = {
                limit = {
                    owner = root
                }
                start_building_construction = building_statue_of_liberty
            }
        }
    }
    
    # Mosque of Djenne
    if = {
        limit = {
            s:STATE_EASTERN_MALI = {
                any_scope_state = {
                    owner = root
                }
                NOT = {
                    any_scope_state = {
                        any_scope_building = {
                            is_building_type = building_mosque_of_djenne
                        }
                    }
                }
            }
        }
        set_local_variable = {
            name = lroai_started_building_construction
            value = yes
            days = lroai_days_to_keep_short_variables
        }
        s:STATE_EASTERN_MALI = {
            random_scope_state = {
                limit = {
                    owner = root
                }
                start_building_construction = building_mosque_of_djenne
            }
        }
    }
    
    # Skyscraper
    random_scope_state = {
        limit = {
            has_modifier = skyscraper_site
            NOT = {
                any_scope_building = {
                    is_building_type = building_skyscraper
                }
            }
        }
        set_local_variable = {
            name = lroai_started_building_construction
            value = yes
            days = lroai_days_to_keep_short_variables
        }
        start_building_construction = building_skyscraper
    }
    
    if = {
        limit = {
            lroai_is_using_compatibility_patches = yes
        }
        lroai_construct_special_buildings_compatibility = yes
    }
}

#
# new in 1.5
#

# ----------
# Vineyard plantation
# ----------

lroai_evaluate_building_vineyard_plantation = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:vine
        offset = 0
    }
}


# -------------
# Artillery foundries
# -------------

lroai_evaluate_building_artillery_foundries = {
    if = {
        limit = {
            OR = {
                lroai_is_using_military_forces = no
                market.mg:artillery.lroai_supply_vs_demand_level <= lroai_max_level_when_using_military_forces
            }
        }
        lroai_evaluate_production_building = {
            id = $id$
            crucial = $crucial$
            good = mg:artillery
            offset = 0
        }
    }
}

# ---------
# Military shipyards
# ---------

lroai_evaluate_building_military_shipyards = {
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 = 1
                lroai_building_type_$id$_collected_data_4 >= 3
            }
        }
        if = {
            limit = {
                OR = {
                    lroai_is_using_military_forces = no
                    market.mg:manowars.lroai_supply_vs_demand_level <= lroai_max_level_when_using_military_forces
                }
            }
            lroai_evaluate_production_building = {
                id = $id$
                crucial = $crucial$
                good = mg:manowars
                offset = 0
            }
        }
    }
    if = {
        limit = {
            OR = {
                NOT = {
                    has_variable = lroai_building_type_$id$_collected_data
                }
                lroai_building_type_$id$_collected_data_4 = 2
                lroai_building_type_$id$_collected_data_4 >= 3
            }
        }
        if = {
            limit = {
                OR = {
                    lroai_is_using_military_forces = no
                    market.mg:ironclads.lroai_supply_vs_demand_level <= lroai_max_level_when_using_military_forces
                }
            }
            lroai_evaluate_production_building = {
                id = $id$
                crucial = $crucial$
                good = mg:ironclads
                offset = 0
            }
        }
    }
}

# ---------------
# Explosives factory
# ---------------

lroai_evaluate_building_explosives_factory = {
    lroai_evaluate_production_building = {
        id = $id$
        crucial = $crucial$
        good = mg:explosives
        offset = 0
    }
}

